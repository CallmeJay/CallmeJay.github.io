---
title: åŸºç¡€çŸ¥è¯†æ€»ç»“-1
date: 2018-10-30 20:49:11
tags: åŸºç¡€
---

### new è¯­æ³•ç³–çš„å®ç°

1, åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡
2, é“¾æ¥åˆ°åŸå‹
3, ç»‘å®šthis
4, è¿”å›æ–°çš„å¯¹è±¡

<!-- more -->

```js
function create(){
  // åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡
  var obj = new Object();
  // è·å¾—æ„é€ å‡½æ•°
  var fn = [].shift.call(arguments);
  // é“¾æ¥åˆ°åŸå‹
  obj.__proto__ = fn.prototype;
  // ç»‘å®šthis æ‰§è¡Œæ„é€ å‡½æ•°
  var result = fn.apply(obj,arguments);
  // ç¡®ä¿è¿”å›çš„æ˜¯å¯¹è±¡
  return typeof(result) === 'object' ? result : obj;
}
```

### æ¨¡æ‹Ÿå®ç°Call å’Œ apply

å¯ä»¥ä»ä»¥ä¸‹å‡ ç‚¹æ¥è€ƒè™‘å¦‚ä½•å®ç°

* ä¸ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤ä¸º window
* æ”¹å˜äº† this æŒ‡å‘ï¼Œè®©æ–°çš„å¯¹è±¡å¯ä»¥æ‰§è¡Œè¯¥å‡½æ•°ã€‚é‚£ä¹ˆæ€è·¯æ˜¯å¦å¯ä»¥å˜æˆç»™æ–°çš„å¯¹è±¡æ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œç„¶ååœ¨æ‰§è¡Œå®Œä»¥ååˆ é™¤ï¼Ÿ

```js
Function.prototype.myCall = function(context){
  var context = context || window;
  // ç»™ context æ·»åŠ ä¸€ä¸ªå±æ€§
  // getValue.call(a, 'yck', '24') => a.fn = getValue
  context.fn = this; // thiså°±æ˜¯è°ƒç”¨callçš„å‡½æ•°
  // å°† context åé¢çš„å‚æ•°å–å‡ºæ¥
  var args = [...arguments].slice(1);
  // getValue.call(a, 'yck', '24') => a.fn('yck', '24')
  var result = context.fn(...args);

  // åˆ é™¤fn
  delete context.fn;
  return result;
}
```

ä»¥ä¸Šå°±æ˜¯ call çš„æ€è·¯ï¼Œapply çš„å®ç°ä¹Ÿç±»ä¼¼

```js
Function.prototype.myApply = function(context){
  var context = context || window
  context.fn = this

  // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¬¬äºŒä¸ªå‚æ•° ä¸”ä¸ºæ•°ç»„
  if(arguments[1] && Array.isArray(arguments[1])){
    var result = context.fn(...arguments[1]);
  }else {
    var result = context.fn();
  }

  delete context.fn;
  return result;
}
```

bind å’Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•ä½œç”¨ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡ bind å®ç°æŸ¯é‡ŒåŒ–ã€‚

```js
Function.prototype.myBind = function (context) {
  if (typeof this !== 'function') {
    throw new TypeError('Error')
  }
  var _this = this
  var args = [...arguments].slice(1)
  // è¿”å›ä¸€ä¸ªå‡½æ•°
  return function F() {
    // å› ä¸ºè¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ new F()ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­
    if (this instanceof F) {
      return new _this(...args, ...arguments)
    }
    return _this.apply(context, args.concat(...arguments))
  }
}
```

### VueåŒå‘ç»‘å®šçš„ç®€å•å®ç°ï¼ˆæ•°æ®åŠ«æŒå’Œå‘å¸ƒè®¢é˜…ï¼‰

Vueå†…éƒ¨å®ç°å®ç”¨äº†`Object.defineProperty()`å’Œå‘å¸ƒè®¢é˜…æ¨¡å¼æ¥å®ç°åŒå‘æ•°æ®ç»‘å®šã€‚

```js
function observe(data){

  // åˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹è±¡
  if(!obj || typeof data !== 'object'){
    return;
  }

  // éå†å¯¹è±¡ï¼Œ
  for(key in data){
    defineReactive(data,key,obj[key]);
  }
}

function defineReactive(data,key,value){

  // é€’å½’å­å±æ€§å€¼
  observe(value);

  Object.defineProperty(data,key,{
    enumerable: true,
    configurable: true,
    get: function reactiveGetter(){
      return value;
    },
    set:function reactiveSetter(newVal){
      value = newVal;
    }
  })
}

var data = {name: 'Jay'};

observe(data);

data.name = 'John';  // set value
data.name; // get value
```

ä»¥ä¸Šä»£ç ç®€å•çš„å®ç°äº†å¦‚ä½•ç›‘å¬æ•°æ®çš„ `set` å’Œ `get` çš„äº‹ä»¶ï¼Œä½†æ˜¯ä»…ä»…å¦‚æ­¤æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦åœ¨é€‚å½“çš„æ—¶å€™ç»™å±æ€§æ·»åŠ å‘å¸ƒè®¢é˜…ã€‚

```html
<div>{{name}}</div>
```

åœ¨è§£æcompileå¦‚ä¸Šæ¨¡æ¿ä»£ç æ—¶ï¼Œé‡ä¸Š `{{name}}` å°±ä¼šç»™å±æ€§ `name` æ·»åŠ å‘å¸ƒè®¢é˜…ã€‚

```js
// é€šè¿‡ Dep è§£è€¦
class Dep(){
  constructor(){
    this.subs = [];
  }

  // è®¢é˜…
  addSub( sub ){
    // sub æ˜¯ Watcher å®ä¾‹
    this.subs.push(sub)
  }

  // å‘å¸ƒ
  notify(){
    this.subs.forEach( sub => {
      sub.update();
    })
  }
}

// å…¨å±€å±æ€§ï¼Œé€šè¿‡è¯¥å±æ€§é…ç½® Watcher æ˜¯watcherå’Œdepå…³è”çš„å”¯ä¸€æ¡¥æ¢ï¼Œä»»ä½•æ—¶å€™ï¼Œéƒ½å¿…é¡»ä¿è¯Dep.targetåªæœ‰ä¸€ä¸ªå€¼ã€‚
Dep.target = null;

function update(){
  document.querySelector('div').innerText = value
}

class Watcher(){
  constructor(obj,key,cb){
    // å°† Dep.target æŒ‡å‘è‡ªå·±
    Dep.target = this;
    this.cb = cb;
    this.obj = obj;
    this.key = key;
    this.value = obj[key]; // ç„¶åè§¦å‘å±æ€§çš„ getter æ·»åŠ ç›‘å¬
    // æœ€åå°† Dep.target ç½®ç©º ä¿è¯åªæœ‰ä¸€ä¸ª
    Dep.target = null;
  }

  update(){
    // è·å¾—æ–°å€¼
    // this.value = this.obj[this.key]; ï¼Ÿï¼Ÿ ä¸Šé¢å·²ç»è·å– è¿™é‡Œåº”è¯¥ä¸ç”¨äºŒæ¬¡è·å–äº†
    // è°ƒç”¨ update æ›´æ–°Dom
    this.cb(this.value);
  }
}

var data = { name: 'yck' };
observe(data);
// æ¨¡æ‹Ÿè§£æåˆ° `{{name}}` è§¦å‘çš„æ“ä½œ
new Watcher(data, 'name', update);
// update Dom innerText
data.name = 'yyy';

```

æ¥ä¸‹æ¥å¯¹ `defineReactive`æ”¹é€ 

```js
function defineReactive(data,key,value){

  observe(value);

  var dp = new Dep();

  Object.defineProperty(data,key,{
    enumerable: true,
    configurable: true,
    get: function reactiveGetter(){

      console.log('get value')
      // å°† Watcher æ·»åŠ åˆ°è®¢é˜…
      if(Dep.target){
        dp.addSub(Dep.target);
      }

      return value;
    },

    set: function reactiveSetter(newVal){
      console.log('set value')
      value = newVal;
      // æ‰§è¡Œ watcher çš„ update æ–¹æ³•
      dp.notify();
    }
  })
}
```

ä»¥ä¸Šå®ç°äº†ä¸€ä¸ªç®€æ˜“çš„åŒå‘ç»‘å®šï¼Œæ ¸å¿ƒæ€è·¯å°±æ˜¯æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡å±æ€§çš„ getter æ¥å®ç°å‘å¸ƒè®¢é˜…çš„æ·»åŠ ã€‚

### å‰ç«¯ç¼“å­˜

åœ¨ä»‹ç»ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ä¸¤ç§ã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„æ—¶å€™ï¼Œæ˜¯å¦éœ€è¦å‘æœåŠ¡å™¨éªŒè¯æœ¬åœ°ç¼“å­˜æ˜¯å¦ä¾æ—§æœ‰æ•ˆã€‚é¡¾åæ€ä¹‰ï¼Œåå•†ç¼“å­˜ï¼Œå°±æ˜¯éœ€è¦å’ŒæœåŠ¡å™¨è¿›è¡Œåå•†ï¼Œæœ€ç»ˆç¡®å®šæ˜¯å¦ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚

### å¼ºåˆ¶ç¼“å­˜

å¼ºåˆ¶ç¼“å­˜åˆ¤æ–­HTTPé¦–éƒ¨å­—æ®µï¼šCache-controlï¼ŒExpiresã€‚

Expiresæ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œå³æœåŠ¡å™¨æ—¶é—´ã€‚æµè§ˆå™¨æ£€æŸ¥å½“å‰æ—¶é—´ï¼Œå¦‚æœè¿˜æ²¡åˆ°å¤±æ•ˆæ—¶é—´å°±ç›´æ¥ä½¿ç”¨ç¼“å­˜æ–‡ä»¶ã€‚ä½†æ˜¯è¯¥æ–¹æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæœåŠ¡å™¨æ—¶é—´ä¸å®¢æˆ·ç«¯æ—¶é—´å¯èƒ½ä¸ä¸€è‡´ã€‚å› æ­¤è¯¥å­—æ®µå·²ç»å¾ˆå°‘ä½¿ç”¨ï¼Œæ˜¯HTTP1.0æ ‡å‡†ä¸‹çš„å­—æ®µã€‚

Cache-controlä¸­çš„max-ageä¿å­˜ä¸€ä¸ªç›¸å¯¹æ—¶é—´ã€‚ä¾‹å¦‚Cache-Control: max-age = 484200ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ”¶åˆ°æ–‡ä»¶åï¼Œç¼“å­˜åœ¨484200så†…å‡æœ‰æ•ˆã€‚å¦‚æœåŒæ—¶å­˜åœ¨Cache-controlå’ŒExpiresï¼Œæµè§ˆå™¨æ€»æ˜¯ä½¿ç”¨Cache-controlã€‚

### åå•†ç¼“å­˜

åå•†ç¼“å­˜é€šè¿‡HTTPçš„Last-Modifiedï¼ŒEtagå­—æ®µè¿›è¡Œåˆ¤æ–­ã€‚

Last-Modifiedæ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨è¿”å›çš„å­—æ®µï¼Œè¡¨ç¤ºæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´ã€‚ä¸‹ä¸€æ¬¡æµè§ˆå™¨è¯·æ±‚èµ„æºæ—¶å°±å‘é€If-Modified-Sinceå­—æ®µã€‚æœåŠ¡å™¨ç”¨æœ¬åœ°Last-Modifiedæ—¶é—´ä¸If-Modified-Sinceæ—¶é—´æ¯”è¾ƒï¼Œå¦‚æœä¸ä¸€è‡´åˆ™è®¤ä¸ºç¼“å­˜å·²è¿‡æœŸå¹¶è¿”å›æ–°èµ„æºç»™æµè§ˆå™¨ï¼›å¦‚æœæ—¶é—´ä¸€è‡´åˆ™å‘é€304çŠ¶æ€ç ï¼Œè®©æµè§ˆå™¨ç»§ç»­ä½¿ç”¨ç¼“å­˜ã€‚

Etagï¼šèµ„æºçš„å®ä½“æ ‡è¯†ï¼ˆå“ˆå¸Œå­—ç¬¦ä¸²ï¼‰ï¼Œå½“èµ„æºå†…å®¹æ›´æ–°æ—¶ï¼ŒEtagä¼šæ”¹å˜ã€‚æœåŠ¡å™¨ä¼šåˆ¤æ–­Etagæ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœå˜åŒ–åˆ™è¿”å›æ–°èµ„æºï¼Œå¦åˆ™è¿”å›304ã€‚

>é™„[å‰ç«¯ç¼“å­˜æœ€ä½³å®è·µ](https://juejin.im/post/5c136bd16fb9a049d37efc47)

### JSå‡½æ•° add(1)(2)(3)(4) å®ç°æ— é™æç´¯åŠ 

é—®é¢˜ï¼šç”¨ JS å®ç°ä¸€ä¸ªæ— é™ç´¯åŠ çš„å‡½æ•° `add`ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
add(1); // 1
add(1)(2);  // 3
add(1)(2)(3)ï¼› // 6
add(1)(2)(3)(4)ï¼› // 10

// ä»¥æ­¤ç±»æ¨
```

æ€è€ƒğŸ¤”ï¼šæˆ‘ä»¬çŸ¥é“æ‰“å°å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ `toString()`æ–¹æ³•ï¼Œå‡½æ•° `add(a)` è¿”å›ä¸€ä¸ªé—­åŒ… `sum(b)`ï¼Œå‡½æ•° `sum()` ä¸­ç´¯åŠ è®¡ç®— `a = a + b`ï¼Œåªéœ€è¦é‡å†™`sum.toString()`æ–¹æ³•è¿”å›å˜é‡ `a` å°±OKäº†ã€‚

å®ç°ï¼š

```js
function add(a){
  let count = 0;
  count = a;
  function sum(b){
    count += b;
    return sum;
  }

  sum.toString = function(){
    return count;
  }
  return sum;
}
```

### è¯¦ç»†è§£æèµ‹å€¼ã€æµ…æ‹·è´å’Œæ·±æ‹·è´çš„åŒºåˆ«

ä¸€ã€èµ‹å€¼ï¼ˆCopyï¼‰
èµ‹å€¼æ˜¯å°†æŸä¸€æ•°å€¼æˆ–å¯¹è±¡èµ‹ç»™æŸä¸ªå˜é‡çš„è¿‡ç¨‹ï¼Œåˆ†ä¸ºä¸‹é¢ 2 éƒ¨åˆ†

* åŸºæœ¬æ•°æ®ç±»å‹ï¼šèµ‹å€¼ï¼Œèµ‹å€¼ä¹‹åä¸¤ä¸ªå˜é‡äº’ä¸å½±å“
* å¼•ç”¨æ•°æ®ç±»å‹ï¼šèµ‹**å€**ï¼Œä¸¤ä¸ªå˜é‡å…·æœ‰ç›¸åŒçš„å¼•ç”¨ï¼ŒæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œç›¸äº’ä¹‹é—´æœ‰å½±å“

äºŒã€æµ…æ‹·è´ï¼ˆShallow Copyï¼‰

åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ç€åŸå§‹å¯¹è±¡å±æ€§å€¼çš„ä¸€ä»½ç²¾ç¡®æ‹·è´ã€‚å¦‚æœå±æ€§æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ï¼Œå¦‚æœå±æ€§æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯å†…å­˜åœ°å€ ï¼Œæ‰€ä»¥å¦‚æœå…¶ä¸­ä¸€ä¸ªå¯¹è±¡æ”¹å˜äº†è¿™ä¸ªåœ°å€ï¼Œå°±ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚

ç®€å•æ¥è¯´å¯ä»¥ç†è§£ä¸ºæµ…æ‹·è´åªè§£å†³äº†ç¬¬ä¸€å±‚çš„é—®é¢˜ï¼Œæ‹·è´ç¬¬ä¸€å±‚çš„**åŸºæœ¬ç±»å‹å€¼**ï¼Œä»¥åŠç¬¬ä¸€å±‚çš„**å¼•ç”¨ç±»å‹åœ°å€**ã€‚

æµ…æ‹·è´ä½¿ç”¨åœºæ™¯

* `Object.assign()` æ–¹æ³•ç”¨äºå°†æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å€¼ä»ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ã€‚å®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚
* å±•å¼€è¿ç®—ç¬¦ `Spread` å®é™…æ•ˆæœå’Œ `Object.assign()` æ˜¯ä¸€æ ·çš„
* `Array.prototype.slice()` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡æ˜¯ä¸€ä¸ªç”± `begin`å’Œ `end`ï¼ˆä¸åŒ…æ‹¬`end`ï¼‰å†³å®šçš„åŸæ•°ç»„çš„**æµ…æ‹·è´**ã€‚åŸå§‹æ•°ç»„ä¸ä¼šè¢«æ”¹å˜ã€‚ ç›¸åº”çš„è¿˜æœ‰`concat`ç­‰.

æµ…æ‹·è´çš„å®ç°

```js
function shallowClone(source) {
  var target = {};
  for (var key in source) {
    if (Object.prototype.hasOwnProperty.call(source, key)) {
      target[key] = source[key];
    }
  }
  return target;
}
```

ä¸‰ã€æ·±æ‹·è´ï¼ˆDeep Copyï¼‰

æ·±æ‹·è´ä¼šæ‹·è´æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶æ‹·è´å±æ€§æŒ‡å‘çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚å½“å¯¹è±¡å’Œå®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ä¸€èµ·æ‹·è´æ—¶å³å‘ç”Ÿæ·±æ‹·è´ã€‚æ·±æ‹·è´ç›¸æ¯”äºæµ…æ‹·è´é€Ÿåº¦è¾ƒæ…¢å¹¶ä¸”èŠ±é”€è¾ƒå¤§ã€‚æ‹·è´å‰åä¸¤ä¸ªå¯¹è±¡äº’ä¸å½±å“ã€‚

æ·±æ‹·è´ä½¿ç”¨åœºæ™¯

* `JSON.parse(JSON.stringify(object))` å­˜åœ¨é—®é¢˜ï¼š
  * `undefined`ã€`symbol` å’Œå‡½æ•°è¿™ä¸‰ç§æƒ…å†µï¼Œä¼šç›´æ¥å¿½ç•¥ã€‚
  * å¾ªç¯å¼•ç”¨æƒ…å†µä¸‹ï¼Œä¼šæŠ¥é”™ã€‚
  * `new Date` æƒ…å†µä¸‹ï¼Œè½¬æ¢ç»“æœä¸æ­£ç¡®ã€‚è§£å†³æ–¹æ³•è½¬æˆå­—ç¬¦ä¸²æˆ–è€…æ—¶é—´æˆ³å°±å¥½äº†ã€‚
* `jQuery.extend()`
* `lodash.cloneDeep()`

æ·±æ‹·è´çš„è‡ªå®ç°

å…¶å®æ·±æ‹·è´å¯ä»¥æ‹†åˆ†æˆ 2 æ­¥ï¼Œæµ…æ‹·è´ + é€’å½’ï¼Œæµ…æ‹·è´æ—¶åˆ¤æ–­å±æ€§å€¼æ˜¯å¦æ˜¯å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¯¹è±¡å°±è¿›è¡Œé€’å½’æ“ä½œï¼Œä¸¤ä¸ªä¸€ç»“åˆå°±å®ç°äº†æ·±æ‹·è´ã€‚

```js
// åˆ¤æ˜¯å¦æ˜¯å¯¹è±¡
function isObject(obj) {
  return typeof obj === 'object' && obj != null;
}

function cloneDeep2(source) {

  if (!isObject(source)) return source; // éå¯¹è±¡è¿”å›è‡ªèº«

  var target = Array.isArray(source) ? [] : {};
  for(var key in source) {
    if (Object.prototype.hasOwnProperty.call(source, key)) {
      if (isObject(source[key])) {
        target[key] = cloneDeep2(source[key]); // æ³¨æ„è¿™é‡Œ
      } else {
        target[key] = source[key];
      }
    }
  }
  return target;
}
```

### è¯æ³•ä½œç”¨åŸŸ

`è¯æ³•ä½œç”¨åŸŸæ„å‘³ç€ä½œç”¨åŸŸæ˜¯ç”±ä¹¦å†™ä»£ç æ—¶å‡½æ•°å£°æ˜çš„ä½ç½®æ¥å†³å®šçš„ã€‚`

ç¼–è¯‘çš„è¯æ³•åˆ†æé˜¶æ®µåŸºæœ¬èƒ½å¤ŸçŸ¥é“å…¨éƒ¨æ ‡è¯†ç¬¦åœ¨å“ªé‡Œä»¥åŠæ˜¯å¦‚ä½•å£°æ˜çš„ï¼Œä»è€Œèƒ½å¤Ÿé¢„æµ‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡ŒæŸ¥æ‰¾ã€‚

* è¯æ³•ä½œç”¨åŸŸæ˜¯åœ¨å†™ä»£ç æˆ–è€…å®šä¹‰æ—¶ç¡®å®šçš„ï¼Œå…³æ³¨å‡½æ•° **åœ¨ä½•å¤„å£°æ˜**ï¼Œä½œç”¨åŸŸé“¾åŸºäºä»£ç åµŒå¥—ã€‚
* åŠ¨æ€ä½œç”¨åŸŸæ˜¯åœ¨è¿è¡Œæ—¶ç¡®å®šçš„ï¼ˆ**thisä¹Ÿæ˜¯**ï¼‰ï¼Œå…³æ³¨å‡½æ•° **ä»ä½•å¤„è°ƒç”¨**ï¼Œä½œç”¨åŸŸé“¾åŸºäºè°ƒç”¨æ ˆã€‚
* JavaScriptå¹¶ **ä¸å…·å¤‡** åŠ¨æ€ä½œç”¨åŸŸï¼Œå®ƒ **åªæœ‰è¯æ³•ä½œç”¨åŸŸ**ã€‚ä½†æ˜¯`this`æœºåˆ¶æŸç§ç¨‹åº¦ä¸Šå¾ˆåƒåŠ¨æ€ä½œç”¨åŸŸã€‚

```js
// è¯æ³•ä½œç”¨åŸŸï¼Œå…³æ³¨å‡½æ•°åœ¨ä½•å¤„å£°æ˜ï¼Œaé€šè¿‡RHSå¼•ç”¨åˆ°äº†å…¨å±€ä½œç”¨åŸŸä¸­çš„a
function foo() {
    console.log( a ); // 2
}

function bar() {
    var a = 3;
    foo();
}

var a = 2;
bar();
```

### ç†è§£ let å¾ªç¯

```js
for (let i = 0; i < 10; i++) {
    console.log( i );
}

console.log( i ); // ReferenceError
```

forå¾ªç¯å¤´éƒ¨çš„letä¸ä»…å°†iç»‘å®šåˆ°äº†forå¾ªç¯çš„å—ä¸­ï¼Œäº‹å®ä¸Šå®ƒå°†å…¶é‡æ–°ç»‘å®šåˆ°äº†å¾ªç¯çš„æ¯ä¸€ä¸ªè¿­ä»£ä¸­ï¼Œç¡®ä¿ä½¿ç”¨ä¸Šä¸€ä¸ªå¾ªç¯è¿­ä»£ç»“æŸæ—¶çš„å€¼é‡æ–°è¿›è¡Œèµ‹å€¼ã€‚

```js
{
    let j;
    for (j = 0; j < 10; j++) {
        let i = j; // æ¯ä¸ªè¿­ä»£é‡æ–°ç»‘å®š!
        console.log( i );
    }
}
```

### å˜é‡æå‡

* ä»»ä½•å£°æ˜åœ¨æŸä¸ªä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œéƒ½å°†é™„å±äºè¿™ä¸ªä½œç”¨åŸŸã€‚
* åŒ…æ‹¬å˜é‡å’Œå‡½æ•°åœ¨å†…çš„æ‰€æœ‰å£°æ˜éƒ½ä¼šåœ¨ä»»ä½•ä»£ç è¢«æ‰§è¡Œå‰é¦–å…ˆè¢«å¤„ç†ã€‚
* `var a = 2;`ä¼šè¢«çœ‹æˆä¸¤ä¸ªå£°æ˜ï¼Œ`var a;`å’Œ`a = 2;`ï¼Œç¬¬ä¸€ä¸ªå£°æ˜åœ¨ **ç¼–è¯‘é˜¶æ®µ** è¿›è¡Œï¼Œç¬¬äºŒä¸ªèµ‹å€¼å£°æ˜ä¼šè¢«ç•™åœ¨åŸåœ°ç­‰å¾… **æ‰§è¡Œé˜¶æ®µ**ã€‚
* æ‰€æœ‰çš„å£°æ˜ï¼ˆå˜é‡å’Œå‡½æ•°ï¼‰éƒ½ä¼šè¢« **ç§»åŠ¨åˆ°å„è‡ªä½œç”¨åŸŸçš„æœ€é¡¶ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšæå‡**
* åªæœ‰å£°æ˜æœ¬èº«ä¼šè¢«æå‡ï¼Œè€ŒåŒ…æ‹¬å‡½æ•°è¡¨è¾¾å¼åœ¨å†…çš„èµ‹å€¼æˆ–å…¶ä»–è¿è¡Œé€»è¾‘å¹¶ä¸ä¼šæå‡ã€‚
* å‡½æ•°å£°æ˜å’Œå˜é‡å£°æ˜éƒ½ä¼šè¢«æå‡ï¼Œä½†æ˜¯ï¼Œ **å‡½æ•°é¦–å…ˆè¢«æå‡ï¼Œç„¶åæ‰æ˜¯å˜é‡**ã€‚

### é—­åŒ…

å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå³ä½¿å‡½æ•°åæ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œï¼Œè¿™æ—¶å°±äº§ç”Ÿäº†é—­åŒ…ã€‚

```js
function foo() {
  var a = 2;
  function bar() {
    console.log( a );
  }
  return bar;
}

var baz = foo();

baz(); // 2 ---- è¿™å°±æ˜¯é—­åŒ…çš„æ•ˆæœ
```

bar()åœ¨è‡ªå·±å®šä¹‰çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–çš„åœ°æ–¹æ‰§è¡Œã€‚

bar()æ‹¥æœ‰è¦†ç›–foo()å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ï¼Œä½¿å¾—è¯¥ä½œç”¨åŸŸèƒ½å¤Ÿä¸€ç›´å­˜æ´»ï¼Œä»¥ä¾›bar()åœ¨ä¹‹åä»»ä½•æ—¶é—´è¿›è¡Œå¼•ç”¨ï¼Œä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶

`bar()æŒæœ‰å¯¹foo()å†…éƒ¨ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨å°±å«åšé—­åŒ…ã€‚`

`å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ã€Ajaxè¯·æ±‚ã€è·¨çª—å£é€šä¿¡ã€Web Workersæˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥ï¼ˆæˆ–è€…åŒæ­¥ï¼‰ä»»åŠ¡ä¸­ï¼Œåªè¦ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…ï¼`
